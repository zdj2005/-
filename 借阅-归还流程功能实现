三、借阅-归还功能演示
 
1.	学生注册账号
1.1 注册账号：检查自己取的用户名与自己的学号是否可用（确保无人占用，保证主键的唯一性）
•	CALL proc_check_username('断鸿殇璃’);
•	CALL proc_check_student_no('23366013');
   
1.2 正式注册自己的账号：
CALL proc_register_user(
    '断鸿殇璃',           -- 用户名
    '123456',           -- 密码
    '23366013',              -- 学号
    '董鹏超',                  -- 学生姓名
    '网络空间安全学院',            -- 院系
    '/path/to/id_card.jpg'   -- 学生证照片路径
);
 
1.3 学生查看自己新注册的用户信息
SELECT uid, user_name, role, gmt_create FROM user WHERE user_name IN ('断鸿殇璃');
SELECT sid, student_no, student_name, department, is_approved, is_frozen FROM student 
WHERE student_no IN ('23366013');
 
 
2. 学生申请借阅证
2.1 学生通过用户端来申请借阅证
INSERT INTO borrow_apply (student_id) VALUES (25);
 

3. 管理员审核通过借阅证
3.1 审核员进行借阅证审核
若成功
UPDATE borrow_apply SET status = 1 WHERE student_id = 19 AND status = 0；
 
3.2 若申请失败
UPDATE borrow_apply SET status = 2 WHERE student_id = 19 AND status = 0;

   
4.学生发起借阅申请
4.1 查询可借阅的书，并选择一本进行借阅申请（JAVA编程思想）
SELECT `图书id`,书名,`图书状态` FROM vw_student_book_query WHERE `图书状态` = 0;
INSERT INTO book_borrow (student_id, book_id, status) VALUES (19, 1, 0);

 
4.2 查阅自己的借阅记录
SELECT * FROM vw_student_book_borrow WHERE `学生id` =1;
   
5.	管理员通过学生发起的借阅请求
5.1 审核员查看待审核的借书申请
SELECT * FROM vw_pending_borrow;
 
5.2 若检测到账号可疑，拒绝借阅请求
CALL proc_reject_borrow(15, @AUDITOR_UID, '学生账号已冻结');
   
5.3  审核通过 同意借书请求
UPDATE book_borrow SET status = 1 WHERE student_id = 19 AND book_id = 2 AND status = 0;
 
6.	学生线下去取书
6.1 图书编号 A_01_001
 
董鹏超同学根据图书编号A_01_001，选择去图书馆A区 01号书架 001编号的位置取书
7.	学生对借书进行评论
7.1 董鹏超同学对借的《Java编程思想》爱不释手 进行正向评论与打分
INSERT INTO book_comment (student_id, book_id, comment, score)
VALUES
(19, 2, '《Java编程思想》把面向对象的核心概念讲透了，集合框架的源码分析帮我理清了Java的底层逻辑', 5);
 
8.	审核员对评论进行审核
8.1 审核通过刚刚提交的评论
UPDATE book_comment 
SET status = 1, -- 审核通过
verify_user_id = @AUDITOR_UID, -- auditor1 专属审核人ID，固定写死
verify_time = NOW()  -- 自动填充当前审核时间
WHERE student_id = 19 AND status = 0; -- 精准条件：只过该学生的待审核评论
 
9.	学生还书
9.1 归还之前借的书
CALL proc_student_return_book(19, 2, @result, @message);SELECT @result AS '执行结果', @message AS '返回消息';
   
10.	管理员审核确认归还
10.1 审核员审核还书申请（被拒）
CALL proc_auditor_process_return(19,2, 3, 0, @result, @message);
SELECT @result AS '执行结果', @message AS '返回消息';
 
 
10.2 审核员审核还书申请（通过）
CALL proc_auditor_process_return(19,2, 2, 1, @result, @message);
SELECT @result AS '执行结果', @message AS '返回消息';
